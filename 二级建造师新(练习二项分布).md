# 关于二建超排的算法设计与验证
### 背景

建造师考试属于国家执业资格，是国家为了加强对建设工程项目管理，提高工程项目总承包及施工管理专业技术人员素质，规范施工管理行为，保证工程质量和施工安全，根据《中华人民共和国建筑法》和《建设工程质量管理条例》的规定，国家对建设工程项目总承包和施工管理关键岗位的专业技术人员实行执业资格制度，纳入全国专业技术人员执业资格制度统一规划，“从事建筑活动的专业技术人员，应当依法取得相应的执业资格证书，并在执业证书许可的范围内从事建筑活动。”。 

目前实施考试是按照，将报考人员按照报考`专业`进行分类，分类后的报考人员按照报考`科目`再次分类，再次分类后的报考人员以30人为一组生成某考生某科目的准考证号。

> 如：准考证号为`151232300101`就是考试科目`1`是`51`省`23`市`23`考点`001`考室`01`座位，专业名称不体现在准考证号中。

### 问题和分析
#### 问题
因为近年来国家的发展，整个社会对建设人员的需求量是与日俱增，所以使得报名参加考试的考生人数屡创新高。因为逐年增高的报考人数，所以造成考试组织工作的难度也逐年增加。难度主要体现在两个方面：一是参考人数多，二是支付的考点的费用不断上涨。具体来讲，作为考试组织者经常会出现，因为参考人数众多，造成了需要新增更多的考点来容纳考生；同时又因为考试考点组织成本的上限已经被国家固定，又造成新增考点困难的问题出现；所以最终的问题归结为**使用有限的成本来容纳更多考生的优化问题**。
#### 分析
依照问题，我对此次考试的参考数据进行了分析，此次考试共三科目，每个科目的缺考率为`29.84%`、`28.71%`和`31.58%`。基于考室的租用成本是固定的，较高的缺考率必然造成成本的浪费，所以我想通过提高考室中的安排人数来提高教室的利用率来解决问题。

### 创建模型
#### 模型假设：
1. 首先参加考试的考生相互是独立的；
2. 不考虑考试科目的专业与考生的参考的相关性；

#### 建立缺考概率模型
有n个考生被安排在一间考室里面参加考试，每个考生只有参加考试和不参加考试两种状态，且考生间是否参加考试时相互独立的，因此这间考室的参考人数满足`二项分布`。

根据`二项分布`我们定义`n`人为一间考室安排总数，`p`为每个考生不参加考试的概率，$0-i$为考室中缺考的人数，那么当教室出现缺考`i`人的概率就为：

$P_{i} = C^{i}_{n}p^{i}(1-p)^{n-i}$

对于由$P_{i}$组成的`二项分布`能通过$f(n,p)$计算出均值$mean$和方差$var$:

$mean,var = f(n,p)$

根据概率模型，我们以$n=30$ $p=0.29$可以计算出从不缺考至全部缺考的概率并画出其概率分布。
![30人缺考情况分布](https://raw.githubusercontent.com/mousestone/kaoshiquekaotongji/master/30%E4%BA%BA%E7%BC%BA%E8%80%83%E6%83%85%E5%86%B5%E5%88%86%E5%B8%83.png)


##### 基于概率模型建立的推算出超排的上限
因为现实中教室的容量毕竟是有限的，所以$安排人数 -缺考人数 \le 教室容量$是一个必要的约束条件。

因为通过概率模型中$f(n,p)$能够得出缺考的均值，所以根据缺考均值我们可以确定超排的上限：

| 安排人数 | 教室容量  | 参加考试人数 |
| :-: | :-:  | :-: |
| 30 | 30 |  21 |
| 31 | 30 |  22 |
| 32 | 30 |  22 |
| 33 | 30 | 23 |
| 34 | 30 |  24 |
| 35 | 30 | 24 |
| 36 | 30 |  25 |
| 37 | 30 | 26|
| 38 | 30 | 27 |
| 39 | 30 | 28 |
| 40 | 30 | 29 |
当超排10人后就达到了教室容量
##### 使用使用上限条件带入模型
求的缺考的模型和超排的上限后，我们就算出因`每超排1个人`可能超过考室（30人）的人数。
![超排后的人数](https://raw.githubusercontent.com/mousestone/kaoshiquekaotongji/master/超排后的人数.png)




具体数值：

| 超排人数 | 超过教室容量人数 |
| :-: | :-: |
| 0 | 0 |
| 1 | 0.0007592250067923597 |
| 2 | 0.00782932419907679 |
| 3 | 0.04178722516191198 |
| 4 | 0.15385766903717388 |
| 5 | 0.439548461571527 |
| 6 | 1.0391806928876355 |
| 7 | 2.1179302969508047 |
| 8 | 3.827988210646731 |
| 9 | 6.265394146174014 |

##### 测试数据确定最优化结果
假定考点容量为100，每个考生每科参考缴费30元，租用考室的费用为300元/间；备用考室是指当达到考生超过教室容量时临时安置的教室；节省后费用就为 考生人数$*$30元$*$节省考室数量$-$备用考场数量$*$300元。

| 总人数 | 超过教室容量人数 | 考场超过人数 | 可以取消考室 | 备用考室 | 实际节省的考场 |节省费用 |
| :-: | :-: | :-: | :-: | :-:| :-: | :-:|
|30 |	0.000000 |	0.000000	| 0| 	0.000000| 0 |0 |
|31|	0.000759|	0.075923|	3	|0.002531| 3 |2700 |
|32|	0.007829|	0.782932|	6|	0.026098| 6  |5400|
|33|	0.041787| 4.178723|	10|	0.139291| 9|8700|
|**34**|	**0.153858**|	**15.385767**|	**13**|	**0.512859**| **12** |**11400** |
|**35**|	**0.439548**|	**43.954846**|	**16**|	**1.465162**| **14** | **13800**|
|**36**| **1.039181**|	**103.918069**|	**20**|	**3.463936**| **16** |**16800** |
|37|	2.117930|	211.793030|	23|	7.059768| 15 |18300 |
|38|	3.827988|	382.798821|	26|	12.759961| 14 |19500|
|39|	6.265394|	626.539415|	30|	20.884647| 9 |20700 |

通过测试我们可以看出当超排为6人的情况下节省的考室最多，当超过6人后节省的考室迅速下降，那么我们再通过概率模型再计算下当超排时考场的有缺考的概率。

![超排后的不满30人的概率](https://raw.githubusercontent.com/mousestone/kaoshiquekaotongji/master/%E8%B6%85%E6%8E%92%E5%90%8E%E7%9A%84%E4%B8%8D%E6%BB%A130%E4%BA%BA.png)

依照上图在安排1-10人超排情况下，以缺考人数最少为约束条件下，我们最好超排`4`人。

#### 结论

通过概率模型，我们使用此次数据证明了超排准考证是可行的，同时我们也确定了超排的最佳人数为`4`人，按照每`100`个考室的考点可以节约`12`个考室。

